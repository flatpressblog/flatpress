var FlatPress={winstancedrag:function(){$(".widget-class").draggable({scroll:!0,helper:function(d){return $(this).clone().appendTo("body").removeClass("widget-class").css({position:"fixed",cursor:"move","list-style-type":"none",margin:"0",padding:"0",width:$(this).width(),height:$(this).height()}).addClass("widget-available")}});$(".widget-instance").draggable({scroll:!0,helper:function(d){return $(this).clone().appendTo("body").removeClass("widget-instance").css({position:"fixed",cursor:"move","list-style-type":"none", width:$(this).width(),height:$(this).height()}).addClass("widget-installed")}})},wplaceholder:function(){$(".widget-placeholder").droppable({accept:".widget-class, .widget-instance",activeClass:"ui-state-highlight",over:function(d,a){$(this).effect("highlight",{color:$(".widget-installed, .widget-available").css("background-color")},1E3)},drop:function(d,a){var b=a.draggable.parent(),e=$(this).parent().attr("id").split("-")[1],c=null;a.draggable.hasClass("widget-instance")?c=a.draggable:(c=$('<li class="'+ a.draggable.attr("class")+'"></li>').append(a.draggable.children().clone()),c.removeClass("widget-class").addClass("widget-instance"));c.children("input").attr("name","widgets["+e+"][]");$(this).replaceWith(c);1>b.children().length&&b.append('<li class="widget-placeholder">Drop here</li>');FlatPress.wreload()}})},winstancedrop:function(){$(".widget-instance").droppable({accept:".widget-class, .widget-instance",activeClass:"ui-state-highlight",over:function(d,a){$(this).effect("highlight",{color:$(".widget-available, .widget-installed").css("background-color")}, 1E3)},drop:function(d,a){var b=a.draggable.parent(),e=$(this).parent().attr("id").split("-")[1],c=null;a.draggable.hasClass("widget-instance")?c=a.draggable:(c=$('<li class="'+a.draggable.attr("class")+'"></li>').append(a.draggable.children().clone()),c.removeClass("widget-class").addClass("widget-instance"));c.children("input").attr("name","widgets["+e+"][]");$(this).after(c);1>b.children().length&&b.append('<li class="widget-placeholder">Drop here</li>');FlatPress.wreload()}})},wtrash:function(){$("#widget-trashcan").droppable({accept:".widget-instance", activeClass:"ui-state-highlight",over:function(d,a){$(this).fadeTo("slow",0.2).fadeTo("slow",1)},drop:function(d,a){var b=a.draggable.parent(),e=$(a.draggable);$(".widget-installed").remove();2>b.children().length&&b.append('<li class="widget-placeholder">Drop here</li>');setTimeout(function(){e.remove()});FlatPress.wreload()}});$(".widget-class").droppable({accept:".widget-instance",activeClass:"ui-state-highlight",over:function(d,a){$(this).effect("highlight",{color:$("#widget-trashcan").css("background-color")}, 1E3)},drop:function(d,a){var b=a.draggable.parent(),e=$(a.draggable);$(".widget-installed").remove();2>b.children().length&&b.append('<li class="widget-placeholder">Drop here</li>');setTimeout(function(){e.remove()});FlatPress.wreload()}})},wreload:function(){this.winstancedrag();this.winstancedrop();this.wplaceholder()}};FlatPress.wreload();FlatPress.wtrash();